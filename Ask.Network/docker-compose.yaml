version: '3.1'

services:

  nginx-production:
    container_name: nginx-production
    image: nginx:1.14.0
    ports:
    - "80:80"
    - "443:443"
    volumes:
    - ./nginx.conf:/etc/nginx/conf.d/default.conf
    - /docker-volumes/etc/letsencrypt/live/ask.network/fullchain.pem:/etc/letsencrypt/live/ask.network/fullchain.pem
    - /docker-volumes/etc/letsencrypt/live/ask.network/privkey.pem:/etc/letsencrypt/live/ask.network/privkey.pem
    # for certbot challenges
    - /docker-volumes/data/letsencrypt:/data/letsencrypt
    networks:
    - internal-network

  ask.network:
    container_name: ask-network
    build:
      context: . # this folder to copy solana/target/idl
      dockerfile: ./ask.network/Dockerfile
    networks:
    - internal-network

  claims.ask.network:
    container_name: ask-network-claims
    build:
      context: ./claims.ask.network
      dockerfile: ./Dockerfile
    networks:
    - internal-network

networks:
  internal-network:
    driver: bridge
